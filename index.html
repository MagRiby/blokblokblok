<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="Block Puzzle">
<meta name="mobile-web-app-capable" content="yes">
<meta name="theme-color" content="#1565C0">
<link rel="manifest" href="manifest.json">
<link rel="apple-touch-icon" href="icon.svg">
<link rel="icon" type="image/svg+xml" href="icon.svg">
<title>Block Puzzle</title>
<link rel="stylesheet" href="styles.css">
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }

/* ---- ANIMATED BACKGROUND ---- */
#bg-anim {
  position: fixed; inset: 0; z-index: 0; pointer-events: none; overflow: hidden;
}
#bg-anim .orb {
  position: absolute; border-radius: 50%; filter: blur(80px); opacity: 0.3;
  animation: orbFloat 12s ease-in-out infinite alternate;
}
#bg-anim .orb:nth-child(1) { width: 300px; height: 300px; background: #42A5F5; top: -50px; left: -50px; animation-delay: 0s; }
#bg-anim .orb:nth-child(2) { width: 250px; height: 250px; background: #1565C0; bottom: -40px; right: -40px; animation-delay: -4s; }
#bg-anim .orb:nth-child(3) { width: 200px; height: 200px; background: #64B5F6; top: 40%; left: 60%; animation-delay: -8s; }
@keyframes orbFloat {
  0% { transform: translate(0, 0) scale(1); }
  33% { transform: translate(40px, -30px) scale(1.1); }
  66% { transform: translate(-30px, 40px) scale(0.9); }
  100% { transform: translate(20px, 20px) scale(1.05); }
}
body.kawaii #bg-anim .orb:nth-child(1) { background: #F48FB1; }
body.kawaii #bg-anim .orb:nth-child(2) { background: #CE93D8; }
body.kawaii #bg-anim .orb:nth-child(3) { background: #FFAB91; }
body.cyber #bg-anim .orb { filter: blur(100px); opacity: 0.15; }
body.cyber #bg-anim .orb:nth-child(1) { background: #0ff; }
body.cyber #bg-anim .orb:nth-child(2) { background: #f0f; }
body.cyber #bg-anim .orb:nth-child(3) { background: #00e676; }
body.moroccan #bg-anim .orb:nth-child(1) { background: #C17F3E; }
body.moroccan #bg-anim .orb:nth-child(2) { background: #1B6B5A; }
body.moroccan #bg-anim .orb:nth-child(3) { background: #2E4057; }

body {
  background: #2979FF;
  display: flex; justify-content: center; align-items: center;
  min-height: 100vh; font-family: 'Segoe UI', Arial, sans-serif;
  overflow: hidden; touch-action: manipulation; user-select: none;
  -webkit-touch-callout: none; -webkit-tap-highlight-color: transparent; -webkit-user-select: none;
  position: relative;
}
</style>
</head>
<body>
<div id="bg-anim"><div class="orb"></div><div class="orb"></div><div class="orb"></div></div>

<div id="start-menu">
  <h1 id="menu-title">üß© Block Puzzle</h1>
  <p class="subtitle" id="menu-subtitle">Fill lines. Score big.</p>
  <div class="menu-grid" id="menu-grid"></div>
  <div id="theme-picker">
    <button class="theme-btn active" data-theme="classic">üéÆ Classic</button>
    <button class="theme-btn" data-theme="kawaii">üå∏ Kawaii</button>
    <button class="theme-btn" data-theme="cyber">‚ö° Cyber</button>
    <button class="theme-btn" data-theme="moroccan">‚ú¶ Zellige</button>
  </div>
  <button id="play-btn">‚ñ∂ PLAY</button>
  <div id="best-score-display"></div>
</div>

<div id="game-container">
  <div id="top-bar">
    <div id="score-display"><span class="trophy">üèÜ</span><span id="score">0</span></div>
    <div id="moves-display">0</div>
  </div>
  <div id="board"></div>
  <div id="pieces-tray"></div>
</div>

<div id="game-over-overlay">
  <h1>Game Over</h1>
  <p>Score: <span id="final-score">0</span></p>
  <button id="restart-btn">Play Again</button>
</div>

<canvas id="particles" style="position:fixed;inset:0;pointer-events:none;z-index:150;"></canvas>
<div id="clear-banner"></div>
<div id="screen-flash"></div>

<script src="game.js"></script>
<script>
if ('serviceWorker' in navigator) navigator.serviceWorker.register('./sw.js');
let lastTap = 0;
document.addEventListener('touchend', e => { const n=Date.now(); if(n-lastTap<300) e.preventDefault(); lastTap=n; }, {passive:false});
document.addEventListener('gesturestart', e => e.preventDefault());
document.addEventListener('gesturechange', e => e.preventDefault());
</script>
</body>
</html>
